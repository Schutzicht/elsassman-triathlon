---
const { lang = Astro.currentLocale || 'en' } = Astro.props;

const labels = {
    en: "Register Now",
    fr: "S'inscrire"
};
---
<div id="sticky-cta" class="fixed bottom-10 right-10 z-[100] group pointer-events-none transition-all duration-700 translate-y-20 opacity-0 md:translate-y-0 md:opacity-100">
    <div class="relative pointer-events-auto">
        <!-- Background Shadow Glow -->
        <div class="absolute inset-0 bg-brand-primary/20 blur-2xl group-hover:bg-brand-primary/40 transition-all duration-700"></div>
        
        <a 
            href={`/${lang}/inscriptions`} 
            class="relative flex items-center justify-center bg-brand-primary text-black px-10 py-5 transition-all duration-500 overflow-hidden"
            style="clip-path: polygon(0 0, 100% 0, 100% 70%, 85% 100%, 0 100%);"
        >
            <div class="flex items-center gap-4">
                <span class="font-tech text-xs font-black uppercase tracking-[0.3em] italic">{labels[lang === 'fr' ? 'fr' : 'en']}</span>
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="4" stroke="currentColor" class="w-4 h-4 group-hover:translate-x-2 transition-transform duration-500">
                    <path stroke-linecap="square" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3" />
                </svg>
            </div>
            
            <!-- Scanning Line Effect -->
            <div class="absolute top-0 left-[-100%] w-full h-full bg-gradient-to-r from-transparent via-white/50 to-transparent animate-scan pointer-events-none"></div>
        </a>
    </div>
</div>

<script>
    const stickyCta = document.getElementById('sticky-cta');
    
    const handleScroll = () => {
        if (!stickyCta) return;
        
        // Only apply scroll logic on mobile/tablets (below md)
        if (window.innerWidth < 768) {
            if (window.scrollY > window.innerHeight * 0.8) {
                stickyCta.classList.remove('translate-y-20', 'opacity-0');
                stickyCta.classList.add('translate-y-0', 'opacity-100');
            } else {
                stickyCta.classList.add('translate-y-20', 'opacity-0');
                stickyCta.classList.remove('translate-y-0', 'opacity-100');
            }
        } else {
            // Ensure visible on desktop
            stickyCta.classList.remove('translate-y-20', 'opacity-0');
            stickyCta.classList.add('translate-y-0', 'opacity-100');
        }
    };

    window.addEventListener('scroll', handleScroll);
    window.addEventListener('resize', handleScroll);
    // Initial check
    handleScroll();
</script>

<style>
    @keyframes scan {
        0% { left: -100%; }
        100% { left: 100%; }
    }
    .animate-scan {
        animation: scan 3s cubic-bezier(0.4, 0, 0.2, 1) infinite;
    }
</style>
